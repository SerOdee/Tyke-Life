<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Tyke Life Festival – About, Infos, Lineup, Tickets, Impressionen, Kontakt." />
  <title>Tyke Life</title>

  <style>
    :root{
      --bg: #fcf8cd;
      --text: #4a494a;
      --accent: #eec01f;
      --stroke: #6cc4c7;

      --dot: rgba(74,73,74,.35);
      --dotActive: #4a494a;

      --max: 980px;
      --pad: 18px;
    }

    @font-face{
      font-family: "Abtos";
      src: url("Abtos.woff2") format("woff2");
      font-weight: 100 900;
      font-style: normal;
      font-display: swap;
    }

    *{box-sizing:border-box}
    html, body{height:100%}
    html{scroll-behavior:smooth}

    body{
      margin:0;
      background: var(--bg);
      color: var(--text);
      font-family: "Abtos", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      overflow:hidden; /* nur scroller scrollt */
    }

    a{color:inherit}
    .wrap{max-width: var(--max); margin:0 auto; padding:0 var(--pad); width:100%}

    /* ===== Passwort-Gate ===== */
    #gate{
      position:relative;
      z-index: 30;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    #gateBox{
      width:100%;
      max-width:420px;
      padding:22px;
      border:1px solid var(--stroke);
      border-radius:18px;
      background: rgba(252,248,205,.75);
    }
    #gateBox h2{
      margin:0 0 10px;
      font-size: 22px;
      letter-spacing:.6px;
      text-transform: uppercase;
      text-align:center;
      color: var(--stroke);
      font-weight: 950;
    }
    #gateBox p{
      margin:0 0 14px;
      color: rgba(74,73,74,.85);
      line-height:1.7;
      text-align:center;
    }
    #gateBox input,#gateBox button{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid var(--stroke);
      background: rgba(252,248,205,.55);
      color: var(--text);
      font:inherit;
      outline:none;
    }
    #gateBox button{
      margin-top:10px;
      background: rgba(238,192,31,.18);
      font-weight: 950;
      letter-spacing:.6px;
      text-transform: uppercase;
      cursor:pointer;
    }
    #gateErr{display:none;color:#b24a4a;font-size:13px;margin-top:10px;text-align:center}

    #content{display:none; position:relative; z-index: 1;}

    /* ===== Scroll Container + Fullscreen Sections ===== */
    .scroller{
      height:100vh;
      overflow-y:auto;
      scroll-snap-type:y mandatory;
      position:relative;
    }
    .section{
      min-height:100vh;
      scroll-snap-align:start;
      display:flex;
      align-items:center;
      padding: 72px 0;
      border-top: 1px solid rgba(108,196,199,.35);
      position:relative;
    }
    .section:first-child{border-top:none}
    @media (max-width: 560px){
      .section{padding: 64px 0;}
    }

    /* ===== Watermarks ===== */
    .wm{
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index:0;
      background-repeat:no-repeat;
      background-position:center;
      background-size: min(78vw, 980px);
      opacity: .08; /* very subtle; tweak if needed */
    }
    .wm.home{ background-image:url("TykeSun.png"); opacity: .10; }
    .wm.other{ background-image:url("Tattoo.png"); opacity: .06; background-size: min(70vw, 900px); }

    /* Make content above watermark */
    .layer{ position:relative; z-index:1; }

    /* ===== Section headers as images ===== */
    .sectionHeader{
      text-align:center;
      margin-bottom: 14px;
    }
    .titleImg{
      display:block;
      margin: 0 auto 10px;
      max-width: min(520px, 86vw);
      max-height: 90px;
      width:auto;
      height:auto;
    }
    .lead{
      margin:0;
      max-width: 72ch;
      line-height: 1.85;
      font-size: 16px;
      color: rgba(74,73,74,.92);
    }
    .lead.center{margin-left:auto; margin-right:auto; text-align:center;}
    .hl{ color: var(--accent); font-weight: 950; }

    /* ===== Right Dot Nav (auto-hide) ===== */
    .dotnav{
      position:fixed;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      display:flex;
      flex-direction: column;
      gap: 10px;
      padding: 10px 8px;
      border: 1px solid var(--stroke);
      border-radius: 999px;
      background: rgba(252,248,205,.70);
      z-index: 50;
      opacity: 2;
      pointer-events:none;
      transition: opacity .25s ease;
    }
    .dotnav.show{
      opacity: 1;
      pointer-events:auto;
    }
    .dotnav a{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: var(--dot);
      border: 1px solid rgba(108,196,199,.55);
      transition: .12s ease;
      position:relative;
      outline:none;
    }
    .dotnav a.active{
      background: var(--dotActive);
      transform: scale(1.15);
      border-color: var(--stroke);
    }
    .dotnav a[data-label]::before{
      content: attr(data-label);
      position:absolute;
      right: 18px;
      top: 50%;
      transform: translateY(-50%);
      white-space: nowrap;
      font-size: 12px;
      letter-spacing:.4px;
      text-transform: uppercase;
      color: rgba(74,73,74,.9);
      background: rgba(252,248,205,.90);
      border: 1px solid var(--stroke);
      padding: 8px 10px;
      border-radius: 999px;
      opacity: 0;
      pointer-events:none;
      transition:.12s ease;
    }
    .dotnav a:hover::before{opacity:1}
    @media (max-width: 680px){
      .dotnav{right:10px}
      .dotnav a[data-label]::before{display:none}
    }

    /* ===== HOME: logo + fade ===== */
    .homeCenter{
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:0;
    }
    .logo{
      width:auto;
      height:auto;
      max-width: 90vw;
      max-height: 60vh;
      opacity: 0;
      animation: logoFade .8s ease-out forwards;
      position:relative;
      z-index:1;
    }
    @keyframes logoFade{
      from{opacity:0; transform: translateY(10px)}
      to{opacity:1; transform:none}
    }

    /* ===== INFOS: Text + Karte ===== */
    .infosGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
      align-items:center;
      margin-top: 10px;
    }
    .map{
      width:100%;
      height:auto;
      display:block;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      background: rgba(252,248,205,.55);
    }
    @media (max-width: 860px){
      .infosGrid{grid-template-columns:1fr}
    }

    /* ===== LINEUP: Namen + überlagerte Bilder ===== */
    .lineupGrid{
      display:grid;
      grid-template-columns: 1fr 1.15fr;
      gap: 24px;
      align-items:center;
      margin-top: 10px;
    }
    .djList{
      list-style:none;
      padding:0;
      margin:0;
      display:flex;
      flex-direction:column;
      gap: 12px;
      align-items: flex-start;
    }
    .djLink{
      display:inline-block;
      text-decoration:none;
      padding: 6px 0;
      border-bottom: 1px solid transparent;
      outline:none;
      cursor:pointer;
    }
    .djLink:hover,
    .djLink:focus-visible{
      border-bottom-color: var(--stroke);
    }
    .djName{
      font-weight: 950;
      font-size: clamp(18px, 2.2vw, 26px);
      letter-spacing: .6px;
      text-transform: uppercase;
    }

    .gallery{
      position:relative;
      height: min(66vh, 520px);
      min-height: 320px;
    }
    .pic{
      position:absolute;
      width: 54%;
      max-width: 380px;
      aspect-ratio: 4 / 5;
      object-fit: cover;
      border-radius: 16px;
      border: 1px solid var(--stroke);
      box-shadow: 0 18px 50px rgba(74,73,74,.18);
      opacity: .88;
      filter: saturate(.98) contrast(1.02) brightness(.98);
      transition: transform .25s ease, filter .25s ease, opacity .25s ease, z-index 0s;
      z-index: 1;
      background: rgba(252,248,205,.5);
    }
    .pic.p1{ left: 3%;  top: 12%; transform: rotate(-6deg); }
    .pic.p2{ left: 32%; top: 2%;  transform: rotate(4deg);  }
    .pic.p3{ left: 18%; top: 30%; transform: rotate(-2deg); }
    .pic.p4{ left: 46%; top: 26%; transform: rotate(7deg);  }
    .pic.active{
      z-index: 10;
      opacity: 1;
      filter: saturate(1.05) contrast(1.06) brightness(1.03);
      transform: rotate(0deg) scale(1.03);
    }
    @media (max-width: 820px){
      .lineupGrid{grid-template-columns:1fr}
      .gallery{height:420px}
      .pic{width:58%}
    }

    /* ===== Tickets Button ===== */
    .btnrow{margin-top:16px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
    .btn{
      display:inline-flex;
      padding:12px 14px;
      border: 1px solid var(--stroke);
      border-radius: 14px;
      text-decoration:none;
      font-weight: 950;
      letter-spacing:.6px;
      text-transform: uppercase;
      background: rgba(252,248,205,.55);
      transition:.12s ease;
    }
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{ background: rgba(238,192,31,.18); }

    /* ===== Impressionen – Desktop 2x3 + paging; Mobile swipe; Lightbox ===== */
    .impFrame{
      margin-top: 14px;
      position: relative;
      border: 1px solid rgba(108,196,199,.6);
      border-radius: 16px;
      padding: 14px;
      background: rgba(252,248,205,.35);
    }
    .impGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    .impThumb{
      width:100%;
      height: 22vh;
      max-height: 210px;
      min-height: 140px;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      object-fit: cover;
      background: rgba(252,248,205,.55);
      cursor:pointer;
    }
    .impArrow{
      position:absolute;
      top:50%;
      transform: translateY(-50%);
      width: 30px;
      height: 30px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(252,248,205,.90);
      color: var(--text);
      font-weight: 950;
      cursor:pointer;
      display:grid;
      place-items:center;
      user-select:none;
      z-index: 2;
    }
    .impArrow:hover{background: rgba(238,192,31,.18)}
    .impArrow.left{left: -14px;}
    .impArrow.right{right: -14px;}
    .impMeta{
      margin-top: 10px;
      font-size: 13px;
      color: rgba(74,73,74,.70);
      text-align:center;
    }

    .impSwipe{
      display:none;
      overflow-x:auto;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      gap: 0;
    }
    .impSlide{
      flex: 0 0 100%;
      scroll-snap-align: center;
      padding: 4px 2px;
      display:flex;
      justify-content:center;
    }
    .impSwipeImg{
      width: 92%;
      height: 52vh;
      max-height: 520px;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      object-fit: cover;
      background: rgba(252,248,205,.55);
      cursor:pointer;
    }
    @media (max-width: 680px){
      .impGrid, .impArrow{ display:none; }
      .impSwipe{ display:flex; }
      .impFrame{ padding: 10px; }
    }

    #lightbox{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(252,248,205,.92);
      z-index: 999;
      padding: 18px;
    }
    #lightbox.open{display:flex;}
    .lbBox{
      position:relative;
      width: min(1100px, 96vw);
      height: min(78vh, 720px);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .lbImg{
      max-width: 100%;
      max-height: 100%;
      width:auto;
      height:auto;
      border-radius: 16px;
      border: 1px solid var(--stroke);
      object-fit: contain;
      background: rgba(252,248,205,.55);
      box-shadow: 0 18px 60px rgba(74,73,74,.22);
    }
    .lbClose{
      position:absolute;
      top: -8px;
      right: -8px;
      width: 34px;
      height: 34px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(252,248,205,.95);
      font-weight: 950;
      cursor:pointer;
      display:grid;
      place-items:center;
    }
    .lbNav{
      position:absolute;
      top:50%;
      transform: translateY(-50%);
      width: 36px;
      height: 36px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(252,248,205,.95);
      font-weight: 950;
      cursor:pointer;
      display:grid;
      place-items:center;
      user-select:none;
    }
    .lbNav:hover, .lbClose:hover{background: rgba(238,192,31,.18)}
    .lbPrev{left: -10px;}
    .lbNext{right: -10px;}

    .fine{
      margin-top: 14px;
      color: rgba(74,73,74,.70);
      font-size: 13px;
      line-height: 1.7;
      text-align:center;
    }
  </style>
</head>

<body>

  <!-- Passwort Gate -->
  <div id="gate">
    <div id="gateBox">
      <h2>PASSWORT</h2>
      <p>Diese Seite ist privat.</p>
      <input id="pw" type="password" placeholder="Passwort eingeben" autocomplete="current-password">
      <button id="enter">ÖFFNEN</button>
      <div id="gateErr">Falsches Passwort.</div>
    </div>
  </div>

  <!-- Content -->
  <div id="content">
    <nav class="dotnav" id="dotnav" aria-label="Sektionen">
      <a href="#home" class="active" data-label="Home"></a>
      <a href="#about" data-label="About"></a>
      <a href="#infos" data-label="Infos"></a>
      <a href="#lineup" data-label="Lineup"></a>
      <a href="#tickets" data-label="Tickets"></a>
      <a href="#impressionen" data-label="Impressionen"></a>
      <a href="#kontakt" data-label="Kontakt"></a>
    </nav>

    <div class="scroller" id="scroller">
      <!-- HOME -->
      <section class="section" id="home" data-dot="0" style="padding:0;border-top:none;">
        <div class="wm home"></div>
        <div class="wrap homeCenter layer">
          <img class="logo" src="logo3.png" alt="TYKE LIFE FESTIVAL" />
        </div>
      </section>

      <!-- ABOUT -->
      <section class="section" id="about" data-dot="1">
        <div class="wm other"></div>
        <div class="wrap layer">
          <div class="sectionHeader">
            <img class="titleImg" src="About.png" alt="About" />
            <p class="lead center">
              <span class="hl">Tyke-Life</span> ist ein kleines Festival – direkt, sauber, ohne unnötigen Kram.
              Hier steht euer Text: Konzept, Vibe, Location-Feeling, Community.
            </p>
          </div>
        </div>
      </section>

      <!-- INFOS -->
      <section class="section" id="infos" data-dot="2">
        <div class="wm other"></div>
        <div class="wrap layer">
          <div class="sectionHeader">
            <img class="titleImg" src="Infos.png" alt="Infos" />
          </div>

          <div class="infosGrid">
            <div>
              <p class="lead">
                <span class="hl">START:</span> 14:00&nbsp;&nbsp;
                <span class="hl">ENDE:</span> 22:00<br/>
                <span class="hl">DATUM:</span> TBA<br/>
                <span class="hl">ORT:</span> TBA<br/>
                <span class="hl">MUSIK:</span> Techno
              </p>
            </div>

            <div>
              <img class="map" src="Karte.png" alt="Kartenausschnitt" />
              <div class="fine" style="text-align:left;margin-top:8px">Karte.png</div>
            </div>
          </div>
        </div>
      </section>

      <!-- LINEUP -->
      <section class="section" id="lineup" data-dot="3">
        <div class="wm other"></div>
        <div class="wrap layer">
          <div class="sectionHeader">
            <img class="titleImg" src="Lineup.png" alt="Lineup" />
            <p class="lead center">
              Hover über einen Namen → <span class="hl">Foto kommt nach vorne</span>. Ohne Hover wechseln wir automatisch.
            </p>
          </div>

          <div class="lineupGrid">
            <ul class="djList" aria-label="DJs">
              <li><a class="djLink" href="#lineup" data-img="Floostix.jpg"><span class="djName">DJ FLOOSTIX</span></a></li>
              <li><a class="djLink" href="#lineup" data-img="arearge.jpg"><span class="djName">ARE:AGE</span></a></li>
              <li><a class="djLink" href="#lineup" data-img="Livio.jpg"><span class="djName">LIVIO</span></a></li>
              <li><a class="djLink" href="#lineup" data-img="DJ4.jpg"><span class="djName">MORE TBA</span></a></li>
            </ul>

            <div class="gallery" aria-label="DJ Bilder">
              <img class="pic p1 active" src="Floostix.jpg" alt="DJ Floostix" data-file="Floostix.jpg" />
              <img class="pic p2" src="arearge.jpg" alt="are:age" data-file="arearge.jpg" />
              <img class="pic p3" src="Livio.jpg" alt="Livio" data-file="Livio.jpg" />
              <img class="pic p4" src="DJ4.jpg" alt="DJ" data-file="DJ4.jpg" />
            </div>
          </div>
        </div>
      </section>

      <!-- TICKETS -->
      <section class="section" id="tickets" data-dot="4">
        <div class="wm other"></div>
        <div class="wrap layer">
          <div class="sectionHeader">
            <img class="titleImg" src="Tickets.png" alt="Tickets" />
            <p class="lead center"><span class="hl">Vorverkauf</span> folgt.</p>
          </div>

          <div class="btnrow">
            <a class="btn primary" href="https://example.com" target="_blank" rel="noopener">TICKET LINK</a>
          </div>

          <p class="fine">Link später ersetzen.</p>
        </div>
      </section>

      <!-- IMPRESSIONEN -->
      <section class="section" id="impressionen" data-dot="5">
        <div class="wm other"></div>
        <div class="wrap layer">
          <div class="sectionHeader">
            <img class="titleImg" src="Impressionen.png" alt="Impressionen" />
            <p class="lead center">
              Fotos aus <span class="hl">/impressionen/</span> (manifest.json).
            </p>
          </div>

          <div class="impFrame">
            <div class="impArrow left" id="impPrev" aria-label="Vorherige">‹</div>
            <div class="impArrow right" id="impNext" aria-label="Nächste">›</div>

            <div class="impGrid" id="impGrid" aria-label="Impressionen Grid"></div>
            <div class="impSwipe" id="impSwipe" aria-label="Impressionen Swipe"></div>

            <div class="impMeta" id="impMeta"></div>
          </div>

          <p class="fine" id="impHint"></p>
        </div>
      </section>

      <!-- KONTAKT -->
      <section class="section" id="kontakt" data-dot="6">
        <div class="wm other"></div>
        <div class="wrap layer">
          <div class="sectionHeader">
            <img class="titleImg" src="Kontakt.png" alt="Kontakt" />
            <p class="lead center">
              Mail: <a href="mailto:info@tyke-life.ch"><span class="hl">info@tyke-life.ch</span></a>
            </p>
          </div>

          <p class="fine">
            © <span id="y"></span> Tyke Life ·
            <a href="#" id="logout" style="text-decoration:none;">Logout</a>
          </p>
        </div>
      </section>
    </div>
  </div>

  <!-- LIGHTBOX -->
  <div id="lightbox" aria-hidden="true">
    <div class="lbBox">
      <button class="lbClose" id="lbClose" aria-label="Schliessen">×</button>
      <button class="lbNav lbPrev" id="lbPrev" aria-label="Zurück">‹</button>
      <img class="lbImg" id="lbImg" alt="Impression gross" />
      <button class="lbNav lbNext" id="lbNext" aria-label="Weiter">›</button>
    </div>
  </div>

  <script>
    /* =========================
       Passwortschutz (Cookie)
       ========================= */
    const PASSWORD = "Yves";   // <<< HIER Passwort setzen
    const COOKIE_NAME = "tyke_access";
    const COOKIE_DAYS = 14;

    const gate = document.getElementById("gate");
    const content = document.getElementById("content");
    const err = document.getElementById("gateErr");
    const pwInput = document.getElementById("pw");

    function setCookie(name, value, days){
      const d = new Date();
      d.setTime(d.getTime() + (days*24*60*60*1000));
      document.cookie = `${name}=${encodeURIComponent(value)}; expires=${d.toUTCString()}; path=/; SameSite=Lax`;
    }
    function getCookie(name){
      const needle = name + "=";
      return document.cookie.split(";").map(c=>c.trim()).find(c=>c.startsWith(needle))?.slice(needle.length) || "";
    }
    function unlock(){
      gate.style.display = "none";
      content.style.display = "block";
      err.style.display = "none";
      showDotsBriefly();
    }
    function lock(){
      gate.style.display = "flex";
      content.style.display = "none";
    }

    if (decodeURIComponent(getCookie(COOKIE_NAME)) === "ok") unlock(); else lock();

    document.getElementById("enter").addEventListener("click", () => {
      if (pwInput.value === PASSWORD) {
        setCookie(COOKIE_NAME, "ok", COOKIE_DAYS);
        unlock();
      } else {
        err.style.display = "block";
        pwInput.select();
      }
    });
    pwInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") document.getElementById("enter").click();
    });

    document.getElementById("logout").addEventListener("click", (e) => {
      e.preventDefault();
      setCookie(COOKIE_NAME, "", -1);
      location.reload();
    });

    /* =========================
       Dotnav auto-hide when idle
       ========================= */
    const dotnav = document.getElementById("dotnav");
    const scroller = document.getElementById("scroller");
    let hideTimer = null;

    function showDotsBriefly(){
      dotnav.classList.add("show");
      clearTimeout(hideTimer);
      hideTimer = setTimeout(()=>dotnav.classList.remove("show"), 1200);
    }

    // show on any scroll / touch / wheel
    ["scroll","wheel","touchmove","keydown"].forEach(evt=>{
      scroller.addEventListener(evt, showDotsBriefly, {passive:true});
    });

    /* =========================
       Dot active (IntersectionObserver)
       ========================= */
    document.getElementById("y").textContent = new Date().getFullYear();

    const dots = Array.from(document.querySelectorAll(".dotnav a"));
    const sections = Array.from(document.querySelectorAll(".section"));

    function setActive(idx){
      dots.forEach((d,i)=>d.classList.toggle("active", i===idx));
    }

    const io = new IntersectionObserver((entries)=>{
      const visible = entries
        .filter(e=>e.isIntersecting)
        .sort((a,b)=>b.intersectionRatio - a.intersectionRatio)[0];
      if(!visible) return;
      const idx = Number(visible.target.dataset.dot || 0);
      setActive(idx);
    }, {threshold:[0.6,0.75,0.9]});

    sections.forEach(s=>io.observe(s));

    dots.forEach(dot=>{
      dot.addEventListener("click",(e)=>{
        e.preventDefault();
        showDotsBriefly();
        const id = dot.getAttribute("href");
        const target = document.querySelector(id);
        if(target) target.scrollIntoView({behavior:"smooth", block:"start"});
      });
    });

    /* =========================
       LINEUP: Hover -> Bild nach vorne
       + Auto-Wechsel
       ========================= */
    const djLinks = Array.from(document.querySelectorAll(".djLink"));
    const pics = Array.from(document.querySelectorAll(".gallery .pic"));

    let hoverLock = false;
    let autoIdx = 0;
    const order = ["Floostix.jpg","arearge.jpg","Livio.jpg","DJ4.jpg"];

    function activate(file){
      pics.forEach(p => p.classList.toggle("active", p.dataset.file === file));
    }
    activate(order[0]);

    function startAuto(){
      return setInterval(()=>{
        if(hoverLock) return;
        autoIdx = (autoIdx + 1) % order.length;
        activate(order[autoIdx]);
      }, 3200);
    }
    let timer = startAuto();

    function pauseAuto(){
      hoverLock = true;
      clearInterval(timer);
    }
    function resumeAuto(){
      hoverLock = false;
      clearInterval(timer);
      timer = startAuto();
    }

    djLinks.forEach(link=>{
      const file = link.dataset.img;

      link.addEventListener("mouseenter", ()=>{
        pauseAuto();
        activate(file);
      });
      link.addEventListener("mouseleave", ()=>{
        resumeAuto();
      });

      link.addEventListener("focus", ()=>{
        pauseAuto();
        activate(file);
      });
      link.addEventListener("blur", ()=>{
        resumeAuto();
      });

      link.addEventListener("click", (e)=>{
        e.preventDefault();
        pauseAuto();
        activate(file);
      });
    });

    /* =========================
       IMPRESSIONEN: load manifest + paging + lightbox + swipe
       ========================= */
    const impGrid = document.getElementById("impGrid");
    const impSwipe = document.getElementById("impSwipe");
    const impHint = document.getElementById("impHint");
    const impMeta = document.getElementById("impMeta");
    const btnPrev = document.getElementById("impPrev");
    const btnNext = document.getElementById("impNext");

    const lb = document.getElementById("lightbox");
    const lbImg = document.getElementById("lbImg");
    const lbClose = document.getElementById("lbClose");
    const lbPrev = document.getElementById("lbPrev");
    const lbNext = document.getElementById("lbNext");

    let impFiles = [];
    let page = 0;
    const pageSize = 6;
    let lbIndex = 0;

    const isMobile = () => window.matchMedia("(max-width: 680px)").matches;

    function openLightbox(idx){
      if(!impFiles.length) return;
      lbIndex = (idx + impFiles.length) % impFiles.length;
      lbImg.src = "impressionen/" + impFiles[lbIndex];
      lb.classList.add("open");
      lb.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }
    function closeLightbox(){
      lb.classList.remove("open");
      lb.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
    }
    function lbGo(dir){
      if(!impFiles.length) return;
      lbIndex = (lbIndex + dir + impFiles.length) % impFiles.length;
      lbImg.src = "impressionen/" + impFiles[lbIndex];
    }

    lbClose.addEventListener("click", closeLightbox);
    lbPrev.addEventListener("click", ()=>lbGo(-1));
    lbNext.addEventListener("click", ()=>lbGo(1));
    lb.addEventListener("click", (e)=>{ if(e.target === lb) closeLightbox(); });

    document.addEventListener("keydown", (e)=>{
      if(!lb.classList.contains("open")) return;
      if(e.key === "Escape") closeLightbox();
      if(e.key === "ArrowLeft") lbGo(-1);
      if(e.key === "ArrowRight") lbGo(1);
    });

    // Lightbox swipe
    let touchX = null;
    lb.addEventListener("touchstart", (e)=>{
      touchX = e.touches[0].clientX;
    }, {passive:true});
    lb.addEventListener("touchend", (e)=>{
      if(touchX === null) return;
      const endX = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0].clientX : touchX;
      const dx = endX - touchX;
      touchX = null;
      if(Math.abs(dx) > 50){
        lbGo(dx < 0 ? 1 : -1);
      }
    }, {passive:true});

    function renderDesktop(){
      const totalPages = Math.max(1, Math.ceil(impFiles.length / pageSize));
      page = Math.min(page, totalPages - 1);

      const start = page * pageSize;
      const slice = impFiles.slice(start, start + pageSize);

      impGrid.innerHTML = "";
      slice.forEach((fn, i)=>{
        const img = document.createElement("img");
        img.className = "impThumb";
        img.src = "impressionen/" + fn;
        img.alt = "Impression";
        img.addEventListener("click", ()=>openLightbox(start + i));
        impGrid.appendChild(img);
      });

      impMeta.textContent = `Seite ${page + 1} / ${totalPages} · ${impFiles.length} Fotos`;
      btnPrev.style.display = totalPages > 1 ? "grid" : "none";
      btnNext.style.display = totalPages > 1 ? "grid" : "none";
    }

    function renderMobile(){
      impSwipe.innerHTML = "";
      impFiles.forEach((fn, i)=>{
        const slide = document.createElement("div");
        slide.className = "impSlide";

        const img = document.createElement("img");
        img.className = "impSwipeImg";
        img.src = "impressionen/" + fn;
        img.alt = "Impression";
        img.addEventListener("click", ()=>openLightbox(i));

        slide.appendChild(img);
        impSwipe.appendChild(slide);
      });

      impMeta.textContent = `${impFiles.length} Fotos · Swipe links/rechts`;
    }

    function renderImpressionen(){
      if(!impFiles.length) return;
      if(isMobile()) renderMobile();
      else renderDesktop();
    }

    btnPrev.addEventListener("click", ()=>{
      page = Math.max(0, page - 1);
      renderDesktop();
    });
    btnNext.addEventListener("click", ()=>{
      const totalPages = Math.max(1, Math.ceil(impFiles.length / pageSize));
      page = Math.min(totalPages - 1, page + 1);
      renderDesktop();
    });

    window.addEventListener("resize", ()=>{
      if(!impFiles.length) return;
      renderImpressionen();
    });

    async function loadImpressionen(){
      try{
        const res = await fetch("impressionen/manifest.json", { cache: "no-cache" });
        if(!res.ok) throw new Error("manifest not found");
        const files = await res.json();
        if(!Array.isArray(files) || files.length === 0) throw new Error("empty manifest");

        impFiles = files.filter(fn => /\.(png|jpg|jpeg|webp|gif)$/i.test(fn));
        if(!impFiles.length) throw new Error("no image files in manifest");

        impHint.textContent = "";
        page = 0;
        renderImpressionen();
      }catch(e){
        impFiles = [];
        impGrid.innerHTML = "";
        impSwipe.innerHTML = "";
        impMeta.textContent = "";
        impHint.textContent = "Keine Impressionen geladen. Bitte /impressionen/manifest.json anlegen.";
        btnPrev.style.display = "none";
        btnNext.style.display = "none";
      }
    }

    loadImpressionen();
  </script>
</body>
</html>
